
<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.3/css/all.css"
        integrity="sha384-SZXxX4whJ79/gErwcOYf+zWLeJdY/qpuqC4cAa9rOGUstPomtqpuNWT9wdPEn2fk" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="icon" href="images/favicon.ico?v=2" type="image/x-icon">
    <link rel="stylesheet" type="text/css" href="style.css" />
    <title>UW Course Evalutation</title>
</head>

<body>
    <nav class="nav-container">
        <img class="nav-logo" src="images/uw_name.gif" alt="UW name">
        <ul class="nav-link-wrapper">
            <li><a href="#" class="nav-link">Search</a></li>
            <li><a href="#" class="nav-link">Directories</a></li>
            <li><a href="#" class="nav-link">Reference Tools</a></li>
        </ul>
    </nav>

    <!-- <hr style="width: 90%; margin: 20px auto; background-color:#E8D3A2; height: 3px;"> -->

    <main>
        <section class="slide-1">
            <h1 class="slide-1-title">UW Course Evaluation</h1>
            <form>
                <i class="fas fa-search"></i>
                <input id="search-input" class="form-control" type="text">
            </form>
            <div class="class-container">
                <table class = "table custom">
                    <tr class = "bg-info">
                        <th data-column="LastName" data-order="desc">Last Name &#9650</th>
                        <th data-column="FirstName" data-order="desc">First Name &#9650</th>
                        <th data-column="Department" data-order="desc">Department &#9650</th>
                        <th data-column="ClassID" data-order="desc">Class ID &#9650</th>
                        <th data-column="Year" data-order="desc">Year &#9650</th>
                        <th data-column="Quarter" data-order="desc">Quarter &#9650</th>

                    </tr>
    
                    <tbody id="myTable">
                        <!--Table is generated by buildTable function below-->
                    </tbody>

                </table>
            </div>
        </section>

        <section class="slide-2">
            <img class="slide-2-img" src="images/uw_area1.jpg" placeholder="UW Area">
            <div class="slide-2-container">
                <p class="slide-2-text">jhkfhsjadkkjhfkjhfadkjlskldfj</p>
            </div>
        </section>
    </main>

    <footer id="testing">
        <img class="footer-img" src="images/uwb_signature.png" alt="UWB">
        <hr color=" #E8D3A2" width="100">
        <div class="info">
            <h4>Course Evaluation Catalog</h4>
            <p>Email: cec@u.washington.edu</p>
            <p>Modified: February 12, 2021</p>            
        </div>
    </footer> 

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="tiny.js"></script>
    <script>
        var myArray = [{
         "FirstName":"Nobil",
         "LastName":"Bower",
         "Department":"Physics",
         "ClassID":"101",
         "Year":"21",
         "Quarter":"WI"
      },
      {
         "FirstName":"Viki",
         "LastName":"Miltun",
         "Department":"English",
         "ClassID":"242",
         "Year":"20",
         "Quarter":"WI"
      }
    ]
        
      //MyArray needs an array like the example above. Remove data in myArray and replace with
      //data from CSV and then remove the buildTable function below this and it should in theory
      //work as long as it follows the formatting.
        buildTable(myArray);
        /*$.ajax({
            method:'GET',
            url:'https://raw.githubusercontent.com/kylevh/TEACHERDATA/main/teacherAndClass.json',
            success:function(response){
                myArray = response
                buildTable(myArray)
                console.log(myArray)
            }

        })*/

        $('#search-input').on('keyup', function(){
            var value = $(this).val()
            console.log('Value:', value)
            var data = searchTable(value, myArray)
            buildTable(data)
        })

        $('th').on('click', function(){
            var column = $(this).data('column')
            var order = $(this).data('order')
            var text = $(this).html()
            text = text.substring(0, text.length -1)

            console.log('clicked', column, order)

            if(order == 'desc'){
                $(this).data('order', "asc")
                myArray = myArray.sort((a,b) => a[column] > b[column] ? 1 : -1)
                text += '&#9660'
            }else {
                $(this).data('order', "desc")
                myArray = myArray.sort((a,b) => a[column] < b[column] ? 1 : -1)
                text += '&#9650'
            }
            $(this).html(text)
            buildTable(myArray)
        })


        //Inputs value which is typed by user into search bar and passes data which the collection of names and 
        //classes, year, quarter, etc. and searches whether the value matches with any FirstName, if so, push
        //out filteredData with all matches.
        function searchTable(value, data){
            var filteredData = []
            for(var i = 0; i < data.length; i++)
            {
                value = value.toLowerCase()
                var name = data[i].LastName.toLowerCase()

                if(name.includes(value)){
                    filteredData.push(data[i])
                }
            }

            return filteredData
        }

        function buildTable(data){
            var table = document.getElementById('myTable')

            table.innerHTML = ''
            
            //Prints rows with all the of the follow collumns from the array
            for (var i = 0; i < data.length; i++){
                var row = `<tr data-href = "">
                                <td>${data[i].LastName}</td>
                                <td>${data[i].FirstName}</td>
                                <td>${data[i].Department}</td>
                                <td>${data[i].ClassID}</td>
                                <td>${data[i].Year}</td>
                                <td>${data[i].Quarter}</td>

                        </tr>`
                        table.innerHTML += row
            }
        }
    </script>

</body>

</html>
